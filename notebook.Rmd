---
title: "R체ckmeldungen zu den Wahlen im Kanton Z체rich 2019"
output:
  html_document:
    df_print: paged
---

Zusammenfassung zu den R체ckmeldungen zum Webauftritt und dem Datenservice w채hrend der Regierungsrats- und Kantonsratswahlen 2019.

```{r, include = FALSE, echo=FALSE, warning=FALSE}
#Setup
library(egg)

library(tidyverse)
library(ggplot2)
library(openxlsx)

```

```{r, include = FALSE, echo=FALSE, warning=FALSE}

#Import Data

BesucherNachZeit <- read.csv("data/besucher.csv", sep=",", header= TRUE, fill=TRUE)



downloads <- read.csv("data/downloads_20190324.csv", sep=",", header= TRUE, fill=TRUE, stringsAsFactors =FALSE)

downloads_top <- downloads %>% arrange(desc(Downloads)) 


BesucherNachZeit_bearbeitet <- BesucherNachZeit %>% 
                                select(Uhrzeit = Bezeichnung, Eindeutige.Besucher) %>% 
                                gather("key","Anzahl", -Uhrzeit)


aktionen <- BesucherNachZeit %>% 
                                select(Uhrzeit = Bezeichnung, Aktionen) %>% 
                                gather("key","Anzahl", -Uhrzeit)

Bewertung <- read.xlsx("data/rating.xlsx")

```

# Anzahl Besucher pro Stunde
```{r, echo=  FALSE,  warning=FALSE, fig.align="left"}

#plot the Visitor Data

p_visitor <- ggplot(data=BesucherNachZeit_bearbeitet, aes(x=Uhrzeit, y=Anzahl, fill=key)) +
                geom_bar(stat="identity", position=position_dodge()) + 
                theme(axis.text.x = element_text( angle=90)) +
                guides(fill=guide_legend(title="Typ")) 

grid.arrange(grobs = lapply(
list(p_visitor),
set_panel_size,
width = unit(10, "cm"),
height = unit(10, "cm")
)) 
```

* [Daten Besucher nach Zeit](data/besucher.csv) - csv

# Aktionen pro Stunde
```{r, echo=  FALSE,  warning=FALSE, fig.align="left"}

#plot the Visitor Data

p_visitor <- ggplot(data=aktionen, aes(x=Uhrzeit, y=Anzahl, fill=key)) +
                geom_bar(stat="identity", position=position_dodge()) + 
                theme(axis.text.x = element_text( angle=90, vjust = 0.3)) +
                guides(fill=guide_legend(title="Typ"))  +
                theme(plot.margin=unit(c(0,0,0,6), "cm"))


 grid.arrange( grobs = lapply(
 list(p_visitor),
 set_panel_size,
 width = unit(10, "cm"),
 height = unit(10, "cm")
 ), ncol=2) 

```


# Datendownload

```{r}


p1 <- ggplot(data=downloads_top[1:10,], aes(x=reorder(Bezeichnung, Downloads), y=Downloads)) +
          geom_bar(stat="identity", fill="steelblue") + 
          coord_flip() + 
          guides(fill=FALSE) + 
          labs(x="") + 
          theme(axis.text=element_text(size=9),
                axis.title=element_text(size=9))


p1
```




# Bewertung der Seite
```{r, echo = FALSE,  warning=FALSE, fig.align="left"}
#plot the rating

p_rating <- ggplot(data=Bewertung, aes(x=Anzahl.Sterne, y=Anzahl.Bewertungen)) +
                geom_bar(stat="identity", fill="steelblue")  + 
                coord_flip() +  
                labs(y= "Anzahl Bewertungen", x = "Anzahl Sterne") +
                theme(plot.margin=unit(c(0,0,0,4), "cm"))

 grid.arrange( grobs = lapply(
 list(p_rating),
 set_panel_size,
 width = unit(10, "cm"),
 height = unit(10, "cm")
 ), ncol=2) 


#ggarrange(p_rating,debug = TRUE)


#ggarrange(p_visitor,p_rating,debug = TRUE)
```

